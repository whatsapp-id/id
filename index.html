<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kenzo Config Decryptor - Pro Edition</title>
    <!-- Font & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root {
            --primary: #00ff41;
            --primary-glow: rgba(0, 255, 65, 0.4);
            --bg: #0a0b10;
            --card-bg: rgba(20, 22, 30, 0.8);
            --text: #e0e0e0;
            --border: rgba(0, 255, 65, 0.2);
        }

        * { box-sizing: border-box; transition: all 0.2s ease; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            background-image: 
                radial-gradient(at 0% 0%, rgba(0, 255, 65, 0.05) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(0, 255, 65, 0.05) 0px, transparent 50%);
            color: var(--text);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 650px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { 
            font-family: 'JetBrains Mono', monospace;
            color: var(--primary);
            margin: 0;
            font-size: 24px;
            letter-spacing: 2px;
            text-shadow: 0 0 10px var(--primary-glow);
        }
        .header p { font-size: 12px; color: #666; margin-top: 10px; text-transform: uppercase; letter-spacing: 1px; }

        /* Custom Upload Area */
        .upload-section {
            border: 2px dashed var(--border);
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 25px;
        }
        .upload-section:hover { border-color: var(--primary); background: rgba(0, 255, 65, 0.05); }
        .upload-section svg { fill: var(--primary); width: 40px; margin-bottom: 10px; opacity: 0.7; }
        .upload-section p { margin: 0; font-size: 14px; color: #aaa; }

        .form-row { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; }
        .input-group { flex: 1; min-width: 200px; }
        
        label { display: block; font-size: 11px; font-weight: 700; color: var(--primary); margin-bottom: 8px; text-transform: uppercase; }

        select, textarea {
            width: 100%;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border);
            color: #fff;
            padding: 12px 15px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            outline: none;
        }
        textarea { height: 80px; resize: none; }
        select:focus, textarea:focus { border-color: var(--primary); box-shadow: 0 0 10px var(--primary-glow); }

        .btn-group { display: flex; gap: 10px; }
        button {
            flex: 2;
            padding: 15px;
            background: var(--primary);
            color: #000;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        button.secondary { flex: 1; background: transparent; border: 1px solid #444; color: #fff; }
        button:hover { transform: translateY(-2px); box-shadow: 0 5px 15px var(--primary-glow); }
        button:active { transform: translateY(0); }

        #resultContainer {
            margin-top: 30px;
            display: none;
            animation: slideUp 0.4s ease-out;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .result-header span { font-size: 11px; font-weight: 700; color: var(--primary); text-transform: uppercase; }

        #resultBox {
            background: #000;
            border-radius: 12px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            line-height: 1.6;
            color: var(--primary);
            border: 1px solid #222;
            position: relative;
            max-height: 400px;
            overflow-y: auto;
        }

        .copy-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #333;
            color: #fff;
            padding: 5px 10px;
            font-size: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .copy-btn:hover { background: var(--primary); color: #000; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

        @media (max-width: 500px) {
            .container { padding: 25px; }
            .form-row { flex-direction: column; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>KENZO DECRYPTOR</h1>
        <p>Advanced VPN Config Snipping Tool</p>
    </div>

    <!-- Upload Box -->
    <div class="upload-section" id="dropZone">
        <svg viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
        <p id="fileLabel">Drop config file here or click to browse</p>
        <input type="file" id="fileInput" hidden>
    </div>

    <div class="form-row">
        <div class="input-group">
            <label>Config Type</label>
            <select id="extSelect"></select>
        </div>
    </div>

    <div class="input-group" style="margin-bottom: 20px;">
        <label>Raw Encrypted Data</label>
        <textarea id="inputConfig" placeholder="Encrypted string will appear here..."></textarea>
    </div>

    <div class="btn-group">
        <button onclick="handleDecrypt()">Decrypt Config</button>
        <button class="secondary" onclick="resetForm()">Clear</button>
    </div>

    <!-- Results Area -->
    <div id="resultContainer">
        <div class="result-header">
            <span>Decryption Success</span>
            <button class="copy-btn" onclick="copyResult()">Copy Result</button>
        </div>
        <div id="resultBox"></div>
    </div>

    <div style="text-align: center; margin-top: 30px; font-size: 10px; color: #444; letter-spacing: 2px;">
        V3.0.0 PRO EDITION
    </div>
</div>

<script>
/**
 * DATA PASSWORDS
 */
const PASSWORDS_RAW = {
    '.bdi': '@technore 2022', '.nm': 'X25ldHN5bmFfbmV0bW9kXw==', '.tut': 'fubvx788b46v',
    '.tmt': '$$$@mfube11!!_$$))012b4u', '.sks': 'dyv35224nossas!!', '.ziv': 'fubvx788b46v',
    '.pb': 'Cw1G6s0K8fJVKZmhSLZLw3L1R3ncNJ2e', '.temt': 'fubvx788B4mev', '.tsn': 'thirdy1996624',
    '.etun': 'dyv35224nossas!!', '.pxp': 'bKps&92&', '.ace': 'Ed ', '.tsd': 'waiting',
    '.ost': 'gggggg', '.wt': 'fuMnrztkzbQ', '.tnl': 'A^ST^f6ASG6AS5asd', '.fks': 'fubvx788b46v',
    '.gv': 'Ed ', '.act': 'fubvx788b46v', '.cnet': 'cnt', '.gibs': 'Ed ', '.dvd': 'dyv35224nossas!!',
    '.ftp': 'Version6', '.fthp': 'furious0982', '.jph': 'fubvx788b46v', '.xsks': 'c7-YOcjyk1k',
    '.ht': 'error', '.ssi': 'Jicv', '.kt': 'kt', '.dvs': 'mtscrypt', '.fnet': '62756C6F6B',
    '.mc': 'fubvx788b46v', '.hub': 'trfre699g79r', '.grd': 'fubvx788b46v', '.hta': 'Ed ',
    '.eug': 'fubvx788b46v', '.sds': 'rdovx202b46v', '.htp': 'chanika acid, gimsara htpcag!!',
    '.bbb': 'xcode788b46z', '.ccc': 'fubgf777gf6', '.ddd': 'fubvx788b46vcatsn', '.eee': 'dyv35182!',
    '.cln': 'fubvx788b46v', '.cyh': 'dyv35182!', '.agn': 'cigfhfghdf665557', '.Tcv2': 'fubvx788b46v',
    '.NT': '0x0', '.ai': 'Ed ', '.cks': '2$dOxdIb6hUpzb*Y@B0Nj!T!E2A6DOLlwQQhs4RO6QpuZVfjGx',
    '.sksrv': 'y$I@no5#lKuR7ZH#eAgORu6QnAF*vP0^JOTyB1ZQ&*w^RqpGkY', '.garuda': 'fubvx788b46v',
    '.tpp': 'Ed ', '.sky': 'fubux788b46v', '.max': 'Ed ',
};

// Inisialisasi dropdown
const select = document.getElementById('extSelect');
Object.keys(PASSWORDS_RAW).sort().forEach(ext => {
    const opt = document.createElement('option');
    opt.value = ext; opt.textContent = ext;
    if(ext === '.tnl') opt.selected = true;
    select.appendChild(opt);
});

/**
 * UPLOAD HANDLER
 */
const dropZone = document.getElementById('dropZone');
const fileInput = document.getElementById('fileInput');
const fileLabel = document.getElementById('fileLabel');

dropZone.onclick = () => fileInput.click();
dropZone.ondragover = (e) => { e.preventDefault(); dropZone.style.borderColor = 'var(--primary)'; };
dropZone.ondragleave = () => { dropZone.style.borderColor = 'var(--border)'; };
dropZone.ondrop = (e) => {
    e.preventDefault();
    dropZone.style.borderColor = 'var(--border)';
    if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
};
fileInput.onchange = (e) => { if (e.target.files.length) handleFile(e.target.files[0]); };

function handleFile(file) {
    fileLabel.innerHTML = `Loaded: <span style="color:var(--primary)">${file.name}</span>`;
    const ext = "." + file.name.split('.').pop().toLowerCase();
    if (PASSWORDS_RAW[ext]) select.value = ext;
    
    const reader = new FileReader();
    reader.onload = (e) => {
        document.getElementById('inputConfig').value = e.target.result;
        handleDecrypt();
    };
    reader.readAsText(file);
}

/**
 * DECRYPTION ENGINE
 */
const base64ToUint8 = (str) => Uint8Array.from(atob(str), c => c.charCodeAt(0));
const uint8ToString = (buf) => new TextDecoder().decode(buf);

function formatConfigOutput(keyValuePairs) {
    const keyMap = {
        'host': 'Host', 'ssh_host': 'Host', 'ssh_port': 'Port', 'ssh_user': 'User', 
        'ssh_password': 'Pass', 'ssh_pass': 'Pass', 'ssh_payload': 'Payload', 
        'payload': 'Payload', 'value': 'Payload', 'proxy_host': 'Proxy', 
        'proxy_port': 'Proxy Port', 'sni': 'SNI', 'server_sni': 'SNI',
        'remark': 'Remark', 'notes': 'Note', 'note': 'Note', 'locked': 'Locked', 
        'mode': 'Mode', 'use_auth': 'UseAuth', 'vless_id': 'User ID', 
        'vmess_id': 'User ID', 'dns_server': 'DNS', 'pub_key': 'Public Key'
    };

    let result = "";
    const config = {};

    keyValuePairs.forEach(line => {
        if (!line || line.trim() === "") return;
        let [key, ...valParts] = line.split(':');
        if (!key) return;
        let k = key.trim().replace(/["{}[\]]/g, '').toLowerCase();
        let v = valParts.join(':').trim().replace(/^"/, '').replace(/"$/, '').replace(/,$/, '').replace(/[{}[\]]/g, '').trim();
        if (v.includes('<')) v = v.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim();
        const label = keyMap[k] || k.charAt(0).toUpperCase() + k.slice(1);
        config[label] = v;
    });

    const priority = ['Remark', 'Host', 'Port', 'User', 'Pass', 'Payload', 'SNI', 'Proxy', 'Mode', 'Locked', 'Note'];
    priority.forEach(label => {
        if (config[label]) result += `[ᯤ] [${label}]: ${config[label]}\n`;
        delete config[label];
    });
    Object.keys(config).sort().forEach(label => {
        if (config[label] && !label.match(/^[0-9]+$/)) result += `[ᯤ] [${label}]: ${config[label]}\n`;
    });
    return result + `\n===========================\nDeveloper: @Kenzo`;
}

async function handleDecrypt() {
    const input = document.getElementById('inputConfig').value.trim();
    const ext = document.getElementById('extSelect').value;
    const resContainer = document.getElementById('resultContainer');
    const resBox = document.getElementById('resultBox');

    if (!input) return;
    resContainer.style.display = 'block';
    resBox.innerHTML = "SYSTEM: Initializing decryption...";

    try {
        if (input.toLowerCase().startsWith('nm-') || ext === '.nm') {
            let configData = input.startsWith('nm-') ? input.split('://')[1] : input;
            const keyHex = CryptoJS.enc.Base64.parse("X25ldHN5bmFfbmV0bW9kXw==");
            const decrypted = CryptoJS.AES.decrypt(configData, keyHex, { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 });
            const resultDec = decrypted.toString(CryptoJS.enc.Utf8);
            if(!resultDec) throw new Error("Netmod encryption mismatch");
            let rawLines = resultDec.replace(/\\n/g, '\n').replace(/\\/g, '').split(/[\n,]/);
            resBox.innerText = formatConfigOutput(rawLines);
        } else {
            let parts = input.split('.');
            if (parts.length < 3) {
                try { let decoded = atob(input); if (decoded.includes('.')) parts = decoded.split('.'); } catch(e) {}
            }

            if (parts.length >= 3) {
                const salt = base64ToUint8(parts[0]);
                const iv = base64ToUint8(parts[1]);
                const dataWithTag = base64ToUint8(parts[2]);
                const ciphertext = dataWithTag.slice(0, -16);
                const tag = dataWithTag.slice(-16);

                let passStr = PASSWORDS_RAW[ext];
                if (ext === '.nm') passStr = atob(passStr);
                
                const passwordBuf = new TextEncoder().encode(passStr);
                const baseKey = await crypto.subtle.importKey("raw", passwordBuf, "PBKDF2", false, ["deriveKey"]);
                const key = await crypto.subtle.deriveKey(
                    { name: "PBKDF2", salt: salt, iterations: 1000, hash: "SHA-256" },
                    baseKey, { name: "AES-GCM", length: 256 }, false, ["decrypt"]
                );

                const decryptedBuf = await crypto.subtle.decrypt(
                    { name: "AES-GCM", iv: iv, additionalData: new Uint8Array(), tagLength: 128 },
                    key, new Uint8Array([...ciphertext, ...tag])
                );

                const decryptedText = uint8ToString(decryptedBuf);
                let pairs = [];
                let entryRegex = /<entry key="(.*?)">(.*?)<\/entry>|<entry key="(.*?)"\s*\/>/g;
                let match;
                while ((match = entryRegex.exec(decryptedText)) !== null) {
                    pairs.push(`${match[1] || match[3]}:${match[2] || ""}`);
                }
                if (pairs.length === 0) pairs = decryptedText.split('\n');
                resBox.innerText = formatConfigOutput(pairs);
            } else {
                throw new Error("Invalid GCM format");
            }
        }
    } catch (e) {
        resBox.innerHTML = `<span style="color: #ff4444;">ERROR: ${e.message}</span>`;
    }
}

function resetForm() {
    document.getElementById('inputConfig').value = '';
    document.getElementById('resultContainer').style.display = 'none';
    fileLabel.innerHTML = `Drop config file here or click to browse`;
}

function copyResult() {
    const text = document.getElementById('resultBox').innerText;
    navigator.clipboard.writeText(text);
    alert("Copied to clipboard!");
}
</script>

</body>
</html>
